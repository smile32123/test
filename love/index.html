<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‹çˆ±å æœ‰æ¬²æ·±åº¦åˆ†æ</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@600&display=swap');

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(233, 30, 99, 0.4); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(233, 30, 99, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(233, 30, 99, 0); }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(180deg, #fffbf9 0%, #ffffff 100%);
            color: #444; 
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box; 
        }

        .container {
            width: 100%;
            max-width: 600px;
            background-color: #ffffff;
            border-radius: 16px; 
            box-shadow: 0 16px 40px rgba(133, 84, 84, 0.1);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .view {
            padding: 30px 35px; 
            box-sizing: border-box;
        }
        
        #quizView, #resultsView {
            display: none; 
        }

        .welcome-icon {
            text-align: center;
            color: #f06292;
            margin-bottom: 20px;
            margin-top: 20px;
        }
        .welcome-icon svg {
            width: 60px;
            height: 60px;
        }

        #welcomeView h1 {
            font-family: 'Noto Serif SC', 'Georgia', serif;
            color: #d15c5c; 
            text-align: center;
            font-size: 2.4em;
            margin-bottom: 40px;
            line-height: 1.4;
        }
        
        .start-btn, .restart-btn { 
            display: block;
            width: 80%;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            color: #fff;
            background-color: #f06292; 
            border: none;
            border-radius: 12px; 
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.2s;
            margin-left: auto;
            margin-right: auto;
        }
        .start-btn:hover, .restart-btn:hover {
            background-color: #e91e63;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(233, 30, 99, 0.2);
        }

        .restart-btn {
            background-color: #fff;
            color: #e91e63;
            border: 2px solid #e91e63;
            width: 60%;
        }
        .restart-btn:hover {
            background-color: #fffafb;
        }

        #progressContainer {
            width: 100%;
            background-color: #fdebee; 
            border-radius: 5px;
            height: 10px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        #progressBar {
            width: 0%;
            height: 100%;
            background-color: #f06292; 
            border-radius: 5px;
            transition: width 0.3s;
            position: relative;
        }
        #progressBar::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 10px;
            height: 10px;
            background: #e91e63;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        .quiz-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            min-height: 30px; 
        }
        .prev-btn {
            background: none;
            border: 1px solid #f8bbd0;
            color: #e91e63;
            padding: 5px 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .prev-btn:hover {
            background: #fff0f5;
            transform: scale(1.05);
        }
        .prev-btn:disabled {
            border-color: #eee;
            color: #ccc;
            cursor: not-allowed;
            background: none;
            transform: none;
        }
        
        #questionText {
            font-size: 1.4em; 
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.4;
            min-height: 60px;
            color: #333;
        }
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        .option-btn {
            padding: 14px;
            font-size: 16px;
            background-color: #fffafb; 
            border: 1px solid #f8e8e8; 
            border-radius: 12px; 
            cursor: pointer;
            text-align: left;
            transition: all 0.2s ease-out; 
            color: #555;
        }
        .option-btn:hover {
            background-color: #fff0f5; 
            border-color: #f06292;
            color: #e91e63;
            transform: translateY(-2px); 
        }
        .option-btn:active {
            transform: scale(0.98); 
        }
        
        .option-btn.selected {
            background-color: #fce4ec;
            border-color: #e91e63;
            color: #c2185b;
            font-weight: bold;
        }

        #resultsView h1 {
            text-align: center;
            font-family: 'Noto Serif SC', 'Georgia', serif;
            color: #d15c5c;
            margin-bottom: 10px;
        }

        .core-trait-card {
            background: linear-gradient(135deg, #fffafb 0%, #ffffff 100%);
            border: 1px solid #fce4ec;
            border-radius: 16px;
            padding: 20px 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(233, 30, 99, 0.05);
        }
        
        #coreTraitTitle {
            font-size: 1.8em;
            font-weight: bold;
            text-align: center;
            color: #e91e63; 
            margin-bottom: 15px;
            margin-top: 10px;
        }
        #coreTraitText {
            font-size: 1em;
            line-height: 1.7;
            background: none; 
            border: none; 
            padding: 0; 
            border-radius: 0;
            margin-bottom: 10px;
            color: #5d4037; 
        }
        
        .report-module {
            margin-bottom: 30px;
        }

        .module-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #4e3440; 
            padding-bottom: 5px;
            margin-bottom: 20px;
            text-align: center; 
            border-bottom: none; 
        }
        .module-title::after {
            content: '';
            display: block;
            width: 50px;
            height: 2px;
            background: #f06292;
            margin: 10px auto 0;
        }
        
        #scorePanel {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px;
            background-color: #fff;
            border: 1px solid #fce4ec;
            border-radius: 12px;
        }
        .score-label {
            font-weight: 600;
            color: #555;
        }
        .score-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #e91e63; 
        }
        
        .analysis-item {
            border: 1px solid #fce4ec;
            border-radius: 12px;
            margin-bottom: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(220, 200, 200, 0.1);
        }
        .analysis-header {
            padding: 15px;
            background-color: #fffafb;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .analysis-body {
            padding: 15px 20px;
            border-top: 1px solid #fce4ec;
            line-height: 1.7;
            background-color: #fff;
            color: #5d4037;
        }
        .analysis-body strong {
            color: #e91e63; 
        }
        
        #actionPlan {
            background-color: #fff0f5; 
            border: 1px solid #f8bbd0;
            border-radius: 12px;
            padding: 25px;
        }
        #actionPlan h3 {
            margin-top: 0;
            color: #c2185b; 
            font-size: 1.3em;
        }
        #actionPlan ul {
            padding-left: 20px;
            line-height: 1.8;
            color: #5d4037;
            list-style-type: none; 
        }
        #actionPlan ul li {
            margin-bottom: 10px;
            position: relative;
        }
        #actionPlan ul li::before {
            content: 'â™¥'; 
            position: absolute;
            left: -22px;
            top: 1px;
            color: #e91e63;
            font-size: 1.1em;
        }
        
        /* --- ç§»åŠ¨ç«¯é€‚é… --- */
        @media (max-width: 600px) {
            body {
                padding: 0; 
            }
            .container {
                border-radius: 0; 
                box-shadow: none; 
                min-height: 100vh;
            }
            .view {
                padding: 25px 20px; 
            }
            #welcomeView h1 {
                font-size: 2.0em; 
            }
            #questionText {
                font-size: 1.3em;
                min-height: 50px;
            }
            .option-btn {
                padding: 12px; 
                font-size: 15px;
            }
            .core-trait-card {
                padding: 15px; 
            }
            #coreTraitTitle {
                font-size: 1.5em; 
            }
            .module-title {
                font-size: 1.3em; 
            }
            .analysis-header {
                padding: 12px 15px;
            }
            .analysis-body {
                padding: 12px 15px;
            }
            #actionPlan {
                padding: 20px;
            }
            .start-btn, .restart-btn {
                width: 90%; 
            }
            .restart-btn {
                width: 80%;
            }
        }
        
    </style>
</head>
<body>

    <div class="container">

        <div id="welcomeView" class="view">
            <div class="welcome-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
            </div>
            <h1>æ‹çˆ±å æœ‰æ¬²<br>æ·±åº¦åˆ†æ</h1>
            <button id="startBtn" class="start-btn">å¼€å§‹åˆ†æ</button>
        </div>

        <div id="quizView" class="view">
            <div id="progressContainer">
                <div id="progressBar"></div>
            </div>
            <div class="quiz-nav">
                <button id="prevBtn" class="prev-btn">&larr; ä¸Šä¸€é¢˜</button>
                <div id="questionMeta">ç¬¬ <span id="currentQ">1</span> / 30 é¢˜</div>
            </div>
            <h2 id="questionText">è¿™é‡Œæ˜¯é—®é¢˜æ–‡æœ¬...</h2>
            <div class="options-grid">
                <button class="option-btn" data-value="5">ç»å¸¸å¦‚æ­¤</button>
                <button class="option-btn" data-value="4">å¶å°”ä¼š</button>
                <button class="option-btn" data-value="3">çœ‹æƒ…å†µ</button>
                <button class="option-btn" data-value="2">å¾ˆå°‘</button>
                <button class="option-btn" data-value="1">ä»ä¸</button>
            </div>
        </div>

        <div id="resultsView" class="view">
            <h1>ä½ çš„äº”ç»´æ·±åº¦åˆ†ææŠ¥å‘Š</h1>
            <div class="report-module core-trait-card">
                <h2 id="coreTraitTitle" class="module-title">[æ ¸å¿ƒç‰¹è´¨æ ‡é¢˜]</h2>
                <p id="coreTraitText">[æ ¸å¿ƒç‰¹è´¨åˆ†ææ–‡æ¡ˆ...]</p>
            </div>
            <div class="report-module">
                <h3 class="module-title">ä½ çš„æ‹çˆ±å æœ‰æ¬²â€œäº”ç»´é›·è¾¾å›¾â€</h3>
                <canvas id="radarChart"></canvas>
            </div>
            <div class="report-module">
                <h3 class="module-title">ä½ çš„äº”ç»´å¾—åˆ† (0-100)</h3>
                <div id="scorePanel"></div>
            </div>
            <div class="report-module">
                <h3 class="module-title">äº”ç»´é€æ¡æ·±åº¦åˆ†æ</h3>
                <div id="analysisPanel"></div>
            </div>
            <div class="report-module">
                <h3 class="module-title">ä½ çš„ä¸“å±è¡ŒåŠ¨å»ºè®®</h3>
                <div id="actionPlan"></div>
            </div>
            <div style="text-align: center; margin-top: 30px; border-top: 1px solid #fce4ec; padding-top: 20px;">
                <button id="restartBtn" class="restart-btn">é‡æ–°æµ‹è¯•</button>
            </div>
        </div>

    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function() {

        // --- 1. æ•°æ®åº“ (DB): V2.2 å›ºå®šæ··æ’ (ä¸å†ä¹±åºï¼Œç¡®ä¿é€»è¾‘ç²¾å‡†) ---
        // é¡ºåºé€»è¾‘ï¼šDim1, Dim2, Dim3, Dim4, Dim5 -> å¾ªç¯ 6 æ¬¡
        const questionBank = [
            // Round 1
            { text: "ä¼´ä¾£å›æ¶ˆæ¯æ…¢ï¼Œæˆ‘å°±èƒ¡æ€ä¹±æƒ³ã€‚", dim: 1 },
            { text: "æˆ‘ä¼šè¦æ±‚ä¼´ä¾£è¿œç¦»æŸäº›æœ‹å‹ã€‚", dim: 2 },
            { text: "ä¼´ä¾£å’Œå¼‚æ€§èŠå¾—å¼€å¿ƒï¼Œæˆ‘ä¼šéš¾å—ã€‚", dim: 3 },
            { text: "æˆ‘å¾ˆæƒ³ï¼ˆæˆ–å·²ç»ï¼‰æŸ¥ä¼´ä¾£çš„æ‰‹æœºã€‚", dim: 4 },
            { text: "æ‹çˆ±ä¸­ï¼Œæˆ‘ä¹Ÿæåº¦éœ€è¦ç‹¬å¤„ç©ºé—´ã€‚", dim: 5 },
            // Round 2
            { text: "æˆ‘éœ€è¦ä¼´ä¾£ç»å¸¸è¯´çˆ±æˆ‘æ‰å®‰å¿ƒã€‚", dim: 1 },
            { text: "æˆ‘ä¼šå¹²æ¶‰ä¼´ä¾£çš„ç©¿ç€æ‰“æ‰®ã€‚", dim: 2 },
            { text: "æˆ‘å¾ˆåœ¨æ„å¼‚æ€§ç»™ä¼´ä¾£ç‚¹èµ/è¯„è®ºã€‚", dim: 3 },
            { text: "æˆ‘è®¤ä¸ºçˆ±äººåº”è¯¥å…±äº«æ‰€æœ‰å¯†ç ã€‚", dim: 4 },
            { text: "æˆ‘è§‰å¾—äº‹äº‹â€œæŠ¥å¤‡è¡Œè¸ªâ€å¾ˆçª’æ¯ã€‚", dim: 5 },
            // Round 3
            { text: "ä¸€åµæ¶ï¼Œæˆ‘å°±æ‹…å¿ƒè¦åˆ†æ‰‹äº†ã€‚", dim: 1 },
            { text: "ä¼´ä¾£çš„é‡å¤§å†³å®šï¼Œå¿…é¡»å¬æˆ‘çš„ã€‚", dim: 2 },
            { text: "æèµ·å‰ä»»ï¼Œæˆ‘ä¼šéå¸¸ä»‹æ„ã€‚", dim: 3 },
            { text: "æˆ‘æƒ³éšæ—¶å®šä½æŒæ¡ä¼´ä¾£è¡Œè¸ªã€‚", dim: 4 },
            { text: "ä¼´ä¾£å¤ªç²˜äººï¼Œæˆ‘å°±æƒ³é€ƒç¦»ã€‚", dim: 5 },
            // Round 4
            { text: "æˆ‘çš„æƒ…ç»ªå®Œå…¨å—ä¼´ä¾£æ€åº¦å½±å“ã€‚", dim: 1 },
            { text: "æˆ‘ä¼šè¯•å›¾æ”¹é€ ä¼´ä¾£çš„ç”Ÿæ´»ä¹ æƒ¯ã€‚", dim: 2 },
            { text: "æˆ‘ä¼šæ•…æ„è¯•æ¢ä¼´ä¾£çš„å¿ è¯šåº¦ã€‚", dim: 3 },
            { text: "æˆ‘ä¼šç¿»çœ‹ä¼´ä¾£çš„ç‰©å“å¯»æ‰¾è››ä¸é©¬è¿¹ã€‚", dim: 4 },
            { text: "æ¯”èµ·çº¦ä¼šï¼Œæˆ‘æœ‰æ—¶æ›´æƒ³æ‰¾æœ‹å‹ç©ã€‚", dim: 5 },
            // Round 5
            { text: "è”ç³»ä¸ä¸Šä¼´ä¾£ï¼Œæˆ‘ä¼šè«åææ…Œã€‚", dim: 1 },
            { text: "æˆ‘ä¼šåˆ¶å®šâ€œæ‹çˆ±è§„åˆ™â€è¦æ±‚å¯¹æ–¹éµå®ˆã€‚", dim: 2 },
            { text: "ä¼´ä¾£å›å®¶æ™šï¼Œæˆ‘ç¬¬ä¸€ååº”æ˜¯çŒœç–‘ã€‚", dim: 3 },
            { text: "ä¼´ä¾£ä¸æ¥ç”µè¯ï¼Œæˆ‘å¿…é¡»çŸ¥é“ä»–åœ¨å¹²å˜›ã€‚", dim: 4 },
            { text: "å‘ç”Ÿå†²çªï¼Œæˆ‘ç¬¬ä¸€ååº”æ˜¯å†·æˆ˜/å›é¿ã€‚", dim: 5 },
            // Round 6
            { text: "ä¼´ä¾£ä¸€æ²‰é»˜ï¼Œæˆ‘å°±ç´§å¼ æ˜¯è‡ªå·±é”™äº†ã€‚", dim: 1 },
            { text: "æˆ‘ä¼šå¹²æ¶‰ä¼´ä¾£æ€ä¹ˆèŠ±é’±ã€‚", dim: 2 },
            { text: "æˆ‘è®¤ä¸ºæ¬£èµå…¶ä»–å¼‚æ€§å°±æ˜¯ä¸å¿ ã€‚", dim: 3 },
            { text: "æˆ‘ä¼šæâ€œçªå‡»æ£€æŸ¥â€éªŒè¯ä¼´ä¾£è¯šå®ã€‚", dim: 4 },
            { text: "æˆ‘è®¤ä¸ºæƒ…ä¾£ä¹Ÿå¿…é¡»æ˜¯ç‹¬ç«‹çš„ä¸ªä½“ã€‚", dim: 5 }
        ];

        // æ–‡æ¡ˆåº“
        const dimensionNames = { 1: "ç„¦è™‘ä¸å®‰å…¨æ„Ÿ", 2: "æ§åˆ¶ä¸å¹²æ¶‰", 3: "å«‰å¦’ä¸çŒœç–‘", 4: "è¾¹ç•Œä¸ä¾µçŠ¯", 5: "ç‹¬ç«‹ä¸ç–ç¦»" };
        
        const coreTraitContent = { 
            1: { title: "é«˜ç„¦è™‘çš„â€œé›·è¾¾â€", text: "åœ¨ä½ çš„æ‹çˆ±æ¨¡å‹ä¸­ï¼Œâ€œç„¦è™‘ä¸å®‰å…¨æ„Ÿâ€æ˜¯æœ€çªå‡ºçš„ç‰¹è´¨ã€‚ä½ çš„ç­”æ¡ˆæ˜¾ç¤ºï¼Œä½ å¯¹ä¼´ä¾£çš„åé¦ˆæåº¦æ•æ„Ÿï¼Œå¸¸å¸¸å› ä¸ºâ€œä¸ç¡®å®šæ€§â€è€Œé™·å…¥å†…è€—ã€‚ä½ æ¸´æœ›é«˜é¢‘çš„è”ç³»å’Œç¡®è®¤ï¼Œè¿™æºäºå†…å¿ƒæ·±å¤„å¯¹â€œå¤±å»è¿æ¥â€çš„ææƒ§ã€‚" }, 
            2: { title: "é«˜æ§åˆ¶çš„â€œå®ˆæŠ¤è€…â€", text: "åœ¨ä½ çš„æ‹çˆ±æ¨¡å‹ä¸­ï¼Œâ€œæ§åˆ¶ä¸å¹²æ¶‰â€æ˜¯æœ€çªå‡ºçš„ç‰¹è´¨ã€‚ä½ çš„ç­”æ¡ˆæ˜¾ç¤ºï¼Œä½ å€¾å‘äºä»‹å…¥ä¼´ä¾£çš„å†³ç­–ã€ç¤¾äº¤ç”šè‡³ç”Ÿæ´»ä¹ æƒ¯ã€‚ä½ é€šè¿‡å»ºç«‹â€œè§„åˆ™â€å’Œâ€œæ”¹é€ å¯¹æ–¹â€æ¥è·å–å®‰å…¨æ„Ÿã€‚è¿™ç§â€œä»¥çˆ±ä¸ºåâ€çš„ç®¡æŸï¼Œå¯èƒ½ä¼šè®©ä¼´ä¾£æ„Ÿåˆ°å‹åŠ›ã€‚" }, 
            3: { title: "é«˜å«‰å¦’çš„â€œçŒé¹°â€",  text: "åœ¨ä½ çš„æ‹çˆ±æ¨¡å‹ä¸­ï¼Œâ€œå«‰å¦’ä¸çŒœç–‘â€æ˜¯æœ€çªå‡ºçš„ç‰¹è´¨ã€‚ä½ çš„ç­”æ¡ˆæ˜¾ç¤ºï¼Œä½ å¯¹â€œæ½œåœ¨å¨èƒâ€æœ‰ç€æƒŠäººçš„æ•é”åº¦ã€‚æ— è®ºæ˜¯å‰ä»»ã€å¼‚æ€§æœ‹å‹è¿˜æ˜¯ç¤¾äº¤åª’ä½“çš„ç‚¹èµï¼Œéƒ½å¯èƒ½è§¦å‘ä½ çš„è­¦æŠ¥ã€‚è¿™ç§é˜²å¾¡æœºåˆ¶è®©ä½ æ—¶åˆ»ç´§ç»·ã€‚" }, 
            4: { title: "é«˜ä¾µçŠ¯çš„â€œé¢†åœ°å·¡è§†è€…â€", text: "åœ¨ä½ çš„æ‹çˆ±æ¨¡å‹ä¸­ï¼Œâ€œè¾¹ç•Œä¸ä¾µçŠ¯â€æ˜¯æœ€çªå‡ºçš„ç‰¹è´¨ã€‚ä½ çš„ç­”æ¡ˆæ˜¾ç¤ºï¼Œä½ è®¤ä¸ºâ€œçˆ±=é€æ˜â€ã€‚ä½ å€¾å‘äºé€šè¿‡æŸ¥æ‰‹æœºã€å®šä½æˆ–å¯†ç å…±äº«æ¥éªŒè¯ä¼´ä¾£çš„å¿ è¯šã€‚ä½ è¯•å›¾é€šè¿‡æ¶ˆé™¤æ‰€æœ‰â€œç§˜å¯†â€æ¥æ¶ˆé™¤ä¸å®‰ã€‚" }, 
            5: { title: "é«˜ç‹¬ç«‹çš„â€œè‡ªç”±é£â€", text: "åœ¨ä½ çš„æ‹çˆ±æ¨¡å‹ä¸­ï¼Œâ€œç‹¬ç«‹ä¸ç–ç¦»â€æ˜¯æœ€çªå‡ºçš„ç‰¹è´¨ã€‚ä½ çš„ç­”æ¡ˆæ˜¾ç¤ºï¼Œå³ä½¿åœ¨æ‹çˆ±ä¸­ï¼Œä½ ä¹Ÿæåº¦çœ‹é‡ä¸ªäººç©ºé—´å’Œéšç§ã€‚ä½ æ’æ–¥è¿‡åº¦ç²˜è…»å’ŒæŠ¥å¤‡ã€‚ä½ çš„ç‹¬ç«‹è®©ä½ ä¿æŒäº†è‡ªæˆ‘ï¼Œä½†ä¹Ÿå¯èƒ½è®©ä¼´ä¾£æ„Ÿåˆ°è¢«â€œæ¨å¼€â€ã€‚" } 
        };
        
        const analysisContent = { 
            1: { high: "å¾—åˆ†<strong>éå¸¸é«˜</strong>ã€‚ååº”å‡ºå¼ºçƒˆçš„<strong>â€œè¢«æŠ›å¼ƒææƒ§â€</strong>ã€‚å¯¹â€œæ–­è”â€é›¶å®¹å¿ï¼Œéœ€è¦ä¼´ä¾£ä¸æ–­æä¾›æ‰¿è¯ºæ‰èƒ½å®‰å¿ƒã€‚", med: "å¾—åˆ†å¤„äº<strong>ä¸­ç­‰èŒƒå›´</strong>ã€‚å¤§éƒ¨åˆ†æ—¶å€™å®‰å®šï¼Œä½†åœ¨å‹åŠ›å¤§æˆ–ä¼´ä¾£å†·æ·¡æ—¶ï¼Œä¼šè§¦å‘ç„¦è™‘æœºåˆ¶ï¼Œé™·å…¥èƒ¡æ€ä¹±æƒ³ã€‚", low: "å¾—åˆ†<strong>éå¸¸ä½</strong>ã€‚å±äº<strong>â€œå®‰å…¨å‹ä¾æ‹â€</strong>ã€‚å¾ˆå°‘å› ä¸ºä¼´ä¾£å›æ¶ˆæ¯æ…¢æˆ–æ­£å¸¸ç¤¾äº¤è€Œäº§ç”Ÿè‡ªæˆ‘æ€€ç–‘ã€‚" }, 
            2: { high: "å¾—åˆ†<strong>éå¸¸é«˜</strong>ã€‚æœ‰å¼ºçƒˆçš„<strong>â€œæ”¹é€ æ¬²â€</strong>ã€‚ä»ç©¿è¡£æ‰“æ‰®åˆ°äº¤å‹åœˆå­ï¼Œéƒ½è¯•å›¾æ–½åŠ å½±å“ï¼Œè®¤ä¸ºè¿™æ˜¯â€œä¸ºä»–/å¥¹å¥½â€ã€‚", med: "å¾—åˆ†å¤„äº<strong>ä¸­ç­‰èŒƒå›´</strong>ã€‚åœ¨åŸåˆ™æ€§é—®é¢˜ä¸Šæ¯”è¾ƒåšæŒï¼Œä½†åœ¨å°äº‹ä¸Šæ„¿æ„æ”¾æƒï¼Œä¸ä¼šå¼ºè¿«å¯¹æ–¹å¿…é¡»æ‰§è¡Œã€‚", low: "å¾—åˆ†<strong>éå¸¸ä½</strong>ã€‚ç»™äºˆä¼´ä¾£æé«˜çš„è‡ªç”±åº¦ã€‚å°Šé‡å¯¹æ–¹çš„ç”Ÿæ´»æ–¹å¼å’Œé€‰æ‹©ï¼Œè®¤ä¸ºçˆ±æ˜¯æ¥çº³è€Œéæ”¹å˜ã€‚" }, 
            3: { high: "å¾—åˆ†<strong>éå¸¸é«˜</strong>ã€‚æ˜¯ä¸ª<strong>â€œå®Œç¾ä¸»ä¹‰æ´ç™–è€…â€</strong>ã€‚å¾ˆéš¾å®¹å¿ä¼´ä¾£ä¸å¼‚æ€§æœ‰ä»»ä½•æ¨¡ç³Šçš„äº’åŠ¨ï¼Œç”šè‡³å¯¹å‰ä»»ä¹Ÿè€¿è€¿äºæ€€ã€‚", med: "å¾—åˆ†å¤„äº<strong>ä¸­ç­‰èŒƒå›´</strong>ã€‚ä¼šåƒé†‹ï¼Œè¿™æ˜¯åœ¨ä¹çš„è¡¨ç°ã€‚ä½†ä¸ä¼šè¿‡åº¦è”æƒ³æˆ–æ— ç«¯æŒ‡è´£ï¼Œé™¤éå¯¹æ–¹çœŸçš„è§¦ç¢°åº•çº¿ã€‚", low: "å¾—åˆ†<strong>éå¸¸ä½</strong>ã€‚å¯¹ä¼´ä¾£æœ‰æé«˜çš„ä¿¡ä»»ï¼Œæˆ–å¯¹è‡ªå·±æå…¶è‡ªä¿¡ã€‚è®¤ä¸ºæ¯ä¸ªäººéƒ½æœ‰ç¤¾äº¤è‡ªç”±ï¼Œæ­£å¸¸çš„å¼‚æ€§äº¤å¾€ä¸æ˜¯å¨èƒã€‚" }, 
            4: { high: "å¾—åˆ†<strong>éå¸¸é«˜</strong>ã€‚æœ‰æ˜æ˜¾çš„<strong>â€œæ•°å­—ç›‘æ§â€å€¾å‘</strong>ã€‚æŸ¥æ‰‹æœºã€æŸ¥å²—ã€å®šä½ï¼Œè¯•å›¾é€šè¿‡â€œæŒæ§ä¿¡æ¯â€æ¥æŒæ§å…³ç³»ã€‚", med: "å¾—åˆ†å¤„äº<strong>ä¸­ç­‰èŒƒå›´</strong>ã€‚é€šå¸¸å°Šé‡éšç§ï¼Œä½†åœ¨ä¿¡ä»»åŠ¨æ‘‡æ—¶ï¼Œä¼šæœ‰æŸ¥é˜…å¯¹æ–¹éšç§çš„å¼ºçƒˆå†²åŠ¨ã€‚", low: "å¾—åˆ†<strong>éå¸¸ä½</strong>ã€‚æ‹¥æœ‰æä½³çš„<strong>â€œè¾¹ç•Œæ„Ÿâ€</strong>ã€‚åšä¿¡å³ä½¿æ˜¯ä¼´ä¾£ä¹Ÿåº”æœ‰ç‹¬ç«‹çš„éšç§ç©ºé—´ï¼Œä»ä¸è¯•å›¾çª¥æ¢ç§˜å¯†ã€‚" }, 
            '5DEC': { high: "å¾—åˆ†<strong>éå¸¸é«˜</strong>ã€‚æ˜¯ä¸€ä¸ª<strong>â€œæ¸…é†’çš„è‡ªç”±æ´¾â€</strong>ã€‚æåº¦æŠ—æ‹’â€œèåˆæ„Ÿâ€ï¼Œéœ€è¦å¤§é‡ç‹¬å¤„æ—¶é—´ï¼Œæœ‰æ—¶ä¼šè®©ä¼´ä¾£è§‰å¾—â€œå†·æ¼ â€ã€‚", med: "å¾—åˆ†å¤„äº<strong>ä¸­ç­‰èŒƒå›´</strong>ã€‚å¹³è¡¡å¾—å¾ˆå¥½ã€‚æ—¢äº«å—äºŒäººä¸–ç•Œçš„äº²å¯†ï¼Œä¹Ÿèƒ½åœ¨ç‹¬å¤„æ—¶è‡ªå¾—å…¶ä¹ã€‚", low: "å¾—åˆ†<strong>éå¸¸ä½</strong>ã€‚<strong>â€œä¾æ‹åº¦å¾ˆé«˜â€</strong>ã€‚å–œæ¬¢å’Œä¼´ä¾£åƒè¿ä½“å©´ä¸€æ ·å¾…åœ¨ä¸€èµ·ï¼Œç‹¬å¤„ä¼šæ„Ÿåˆ°å¯‚å¯æˆ–ä¸å®‰ã€‚" } 
        };
        
        const actionPlanContent = { 
            1: "<h3>ğŸ’¡ ç»™â€œé«˜ç„¦è™‘é›·è¾¾â€çš„å»ºè®®</h3><ul><li><strong>å»ºç«‹â€œæƒ…ç»ªæš‚åœåŒºâ€ï¼š</strong> å¯¹æ–¹æ²¡å›æ¶ˆæ¯æ—¶ï¼Œå¼ºè¿«è‡ªå·±æ”¾ä¸‹æ‰‹æœº 15 åˆ†é’Ÿï¼Œå»åšä¸€ä»¶æ¯«ä¸ç›¸å…³çš„äº‹ï¼Œæ‰“æ–­ç„¦è™‘å›è·¯ã€‚</li><li><strong>åŒºåˆ†â€œäº‹å®â€ä¸â€œè„‘è¡¥â€ï¼š</strong> é—®è‡ªå·±ï¼šâ€œä»–ä¸å›æ¶ˆæ¯æ˜¯äº‹å®ï¼Œä½†ä¸çˆ±æˆ‘æ˜¯è„‘è¡¥ã€‚â€ åˆ«æŠŠè„‘è¡¥å½“çœŸã€‚</li></ul>", 
            2: "<h3>ğŸ’¡ ç»™â€œé«˜æ§åˆ¶å®ˆæŠ¤è€…â€çš„å»ºè®®</h3><ul><li><strong>è¯¾é¢˜åˆ†ç¦»ï¼š</strong> ä½ çš„æƒ…ç»ªæ˜¯ä½ çš„è¯¾é¢˜ï¼Œä»–çš„é€‰æ‹©æ˜¯ä»–çš„è¯¾é¢˜ã€‚ä¸èƒ½é€šè¿‡å¹²æ¶‰ä»–çš„é€‰æ‹©æ¥è§£å†³ä½ çš„æƒ…ç»ªé—®é¢˜ã€‚</li><li><strong>æŠŠâ€œå‘½ä»¤â€æ¢æˆâ€œé‚€è¯·â€ï¼š</strong> åˆ«è¯´â€œä½ ä¸è®¸å»â€ï¼Œè¯•ç€è¯´â€œæˆ‘ä»Šæ™šå¾ˆæƒ³ä½ é™ªæˆ‘ï¼Œå¯ä»¥å—ï¼Ÿâ€ã€‚</li></ul>", 
            3: "<h3>ğŸ’¡ ç»™â€œé«˜å«‰å¦’çŒé¹°â€çš„å»ºè®®</h3><ul><li><strong>åœæ­¢â€œååˆâ€å‰ä»»ï¼š</strong> å‰ä»»æ˜¯è¿‡å»å¼ï¼Œæ¯æ¬¡æåŠéƒ½æ˜¯æŠŠâ€œé¬¼é­‚â€æ‹‰åˆ°ç°åœ¨ã€‚å¼ºè¡Œåœæ­¢å¯¹å‰ä»»è¯é¢˜çš„æŒ–æ˜ã€‚</li><li><strong>å»ºç«‹è‡ªä¿¡é”šç‚¹ï¼š</strong> å«‰å¦’æºäºâ€œæˆ‘ä¸å¤Ÿå¥½â€ã€‚åˆ—å‡ºä½ è‡ªå·±çš„ 3 ä¸ªç‹¬ç‰¹ä¼˜ç‚¹ï¼Œå»ºç«‹æ ¸å¿ƒè‡ªä¿¡ã€‚</li></ul>", 
            4: "<h3>ğŸ’¡ ç»™â€œé«˜è¾¹ç•Œä¾µçŠ¯è€…â€çš„å»ºè®®</h3><ul><li><strong>ç‰©ç†éš”ç¦»ï¼š</strong> æ—¢ç„¶ç®¡ä¸ä½æ‰‹ï¼Œå°±è®©æ‰‹æœºç¦»å¼€è§†çº¿ã€‚å½“ä»–å»æ´—æ¾¡æ—¶ï¼Œå¼ºè¿«è‡ªå·±ä¸çœ‹ä»–çš„æ‰‹æœºï¼Œè¿™æ˜¯è„±æ•æ²»ç–—ã€‚</li><li><strong>ç›´é¢ææƒ§ï¼š</strong> é—®è‡ªå·±ï¼šâ€œå¦‚æœæŸ¥åˆ°äº†ä»€ä¹ˆï¼Œæˆ‘å‡†å¤‡å¥½åˆ†æ‰‹äº†å—ï¼Ÿâ€å¦‚æœæ²¡å‡†å¤‡å¥½ï¼ŒæŸ¥æ‰‹æœºåªä¼šå¾’å¢ç—›è‹¦ã€‚</li></ul>", 
            5: "<h3>ğŸ’¡ ç»™â€œé«˜ç‹¬ç«‹è‡ªç”±é£â€çš„å»ºè®®</h3><ul><li><strong>ä¸»åŠ¨æŠ¥å¤‡ä¸€æ¬¡ï¼š</strong> è¯•ç€æ¯å¤©ä¸»åŠ¨åˆ†äº«ä¸€ä»¶å°äº‹ï¼Œè¿™ä¸ä¼šç‰ºç‰²è‡ªç”±ï¼Œä½†èƒ½ç»™å¯¹æ–¹å·¨å¤§çš„å®‰å…¨æ„Ÿã€‚</li><li><strong>è‚¯å®šå¯¹æ–¹éœ€æ±‚ï¼š</strong> å½“ä¼´ä¾£ç²˜äººæ—¶ï¼Œå…ˆåˆ«æ€¥ç€æ¨å¼€ï¼Œå…ˆæŠ±ä¸€ä¸‹è¯´â€œæˆ‘çŸ¥é“ä½ æƒ³æˆ‘â€ï¼Œå†å»å¿™è‡ªå·±çš„äº‹ã€‚</li></ul>" 
        };

        // --- 3. çŠ¶æ€å˜é‡ ---
        let currentQuestionIndex = 0;
        let userRawScores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 }; 
        let finalStandardScores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };
        let userAnswers = new Array(30).fill(null); 

        // --- 4. DOM å…ƒç´  ---
        const views = { welcome: document.getElementById('welcomeView'), quiz: document.getElementById('quizView'), results: document.getElementById('resultsView') };
        const startBtn = document.getElementById('startBtn');
        const progressBar = document.getElementById('progressBar');
        const currentQ = document.getElementById('currentQ');
        const questionText = document.getElementById('questionText');
        const optionBtns = document.querySelectorAll('.option-btn');
        const prevBtn = document.getElementById('prevBtn'); 
        const restartBtn = document.getElementById('restartBtn'); 
        const scorePanel = document.getElementById('scorePanel');
        const analysisPanel = document.getElementById('analysisPanel');
        const actionPlan = document.getElementById('actionPlan');
        const coreTraitTitle = document.getElementById('coreTraitTitle');
        const coreTraitText = document.getElementById('coreTraitText');
        const chartCtx = document.getElementById('radarChart').getContext('2d');
        let radarChartInstance = null; 

        // --- 5. æ ¸å¿ƒé€»è¾‘ ---

        // V2.2: æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„ã€æœ€ç»ˆç»“æœã€‘ï¼Œè€Œä¸æ˜¯è¿‡ç¨‹
        const savedResult = localStorage.getItem('love_quiz_final_result');
        if (savedResult) {
            try {
                const data = JSON.parse(savedResult);
                finalStandardScores = data.scores; // æ¢å¤åˆ†æ•°
                views.welcome.style.display = 'none';
                views.results.style.display = 'block';
                renderReport(data.maxDim, data.radarScores);
            } catch(e) { localStorage.removeItem('love_quiz_final_result'); }
        }

        function resetQuiz() {
            currentQuestionIndex = 0;
            userRawScores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };
            finalStandardScores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };
            userAnswers = new Array(30).fill(null); 
            if (radarChartInstance) { radarChartInstance.destroy(); radarChartInstance = null; }
        }
        
        function restartQuiz() {
            localStorage.removeItem('love_quiz_final_result'); // æ¸…é™¤ç»“æœ
            resetQuiz();
            views.results.style.display = 'none';
            views.welcome.style.display = 'block';
        }

        function startQuiz() {
            resetQuiz(); 
            views.welcome.style.display = 'none';
            views.quiz.style.display = 'block';
            displayQuestion();
        }

        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }
        
        function handleOptionClick(event) {
            const selectedValue = parseInt(event.target.dataset.value);
            const btn = event.target;
            btn.classList.add('selected'); 
            
            userAnswers[currentQuestionIndex] = selectedValue; 

            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < 30) { 
                    displayQuestion();
                } else {
                    calculateResults();
                }
            }, 150); 
        }

        function displayQuestion() {
            const q = questionBank[currentQuestionIndex];
            questionText.textContent = q.text;
            currentQ.textContent = currentQuestionIndex + 1;
            progressBar.style.width = `${((currentQuestionIndex + 1) / 30) * 100}%`; 
            
            prevBtn.disabled = (currentQuestionIndex === 0);
            optionBtns.forEach(btn => btn.classList.remove('selected'));

            const existingAnswer = userAnswers[currentQuestionIndex];
            if (existingAnswer) {
                const selectedBtn = document.querySelector(`.option-btn[data-value="${existingAnswer}"]`);
                if (selectedBtn) selectedBtn.classList.add('selected');
            }
        }
        
        function calculateResults() {
            userRawScores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };

            for (let i = 0; i < 30; i++) { 
                const q = questionBank[i];
                const selectedValue = userAnswers[i];
                if (selectedValue) { 
                    // V2.2: ç›´æ¥ç´¯åŠ åˆ†æ•° (æ‰€æœ‰é¢˜ç›®å‡ä¸ºæ­£å‘è®¡åˆ†)
                    userRawScores[q.dim] += selectedValue;
                }
            }

            let maxScore = -1;
            let maxDim = 1;
            const radarScores = [];

            for (let i = 1; i <= 5; i++) {
                const rawScore = userRawScores[i]; 
                const standardScore = Math.round(((rawScore - 6) / (30 - 6)) * 100);
                finalStandardScores[i] = standardScore;
                radarScores.push(standardScore);

                if (standardScore > maxScore) {
                    maxScore = standardScore;
                    maxDim = i;
                }
            }
            
            // V2.2: ä¿å­˜æœ€ç»ˆè®¡ç®—ç»“æœ
            localStorage.setItem('love_quiz_final_result', JSON.stringify({
                maxDim: maxDim,
                radarScores: radarScores,
                scores: finalStandardScores
            }));

            views.quiz.style.display = 'none';
            views.results.style.display = 'block';
            
            renderReport(maxDim, radarScores);
        }

        function renderReport(maxDim, radarScores) {
            // V2.2: ç¡®ä¿ finalStandardScores å°±ç®—æ˜¯ä» localStorage æ¢å¤çš„ä¹Ÿæœ‰å€¼
            if (!finalStandardScores[1]) {
                 for(let i=0; i<5; i++) finalStandardScores[i+1] = radarScores[i];
            }

            coreTraitTitle.textContent = `${coreTraitContent[maxDim].title} (${finalStandardScores[maxDim]}åˆ†)`;
            coreTraitText.textContent = coreTraitContent[maxDim].text;
            
            const isMobile = window.innerWidth <= 600;
            const chartLabelSize = isMobile ? 10 : 14;
            const chartTickSize = isMobile ? 9 : 12;

            const chartConfig = {
                type: 'radar',
                data: {
                    labels: [dimensionNames[1], dimensionNames[2], dimensionNames[3], dimensionNames[4], dimensionNames[5]],
                    datasets: [{
                        label: 'ä½ çš„å¾—åˆ†',
                        data: radarScores,
                        backgroundColor: 'rgba(233, 30, 99, 0.2)', 
                        borderColor: '#e91e63', 
                        borderWidth: 2,
                        pointBackgroundColor: '#c2185b' 
                    }]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: { color: '#fce4ec' }, 
                            grid: { color: '#fce4ec' }, 
                            suggestedMin: 0, suggestedMax: 100,
                            pointLabels: { font: { size: chartLabelSize, family: 'sans-serif' }, color: '#5d4037' },
                            ticks: { backdropColor: '#fffafb', backdropPadding: 4, color: '#999', font: { size: chartTickSize } }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            };

            if (radarChartInstance) radarChartInstance.destroy();
            radarChartInstance = new Chart(chartCtx, chartConfig);

            scorePanel.innerHTML = '';
            analysisPanel.innerHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                const score = finalStandardScores[i];
                const name = dimensionNames[i];
                
                scorePanel.innerHTML += `
                    <div class="score-item">
                        <span class="score-label">${name}</span>
                        <span class="score-value">${score} / 100</span>
                    </div>
                `;
                
                let analysisText = '';
                const key = (i === 5) ? '5DEC' : i;
                
                if (score > 70) analysisText = analysisContent[key].high;
                else if (score > 40) analysisText = analysisContent[key].med;
                else analysisText = analysisContent[key].low;
                
                analysisPanel.innerHTML += `
                    <div class="analysis-item">
                        <div class="analysis-header"><span>${i}. ${name}</span><span>${score} åˆ†</span></div>
                        <div class="analysis-body">${analysisText}</div>
                    </div>
                `;
            }
            
            actionPlan.innerHTML = actionPlanContent[maxDim];
        }

        startBtn.addEventListener('click', startQuiz);
        restartBtn.addEventListener('click', restartQuiz); 
        prevBtn.addEventListener('click', goToPreviousQuestion); 
        
        optionBtns.forEach(button => {
            button.addEventListener('click', handleOptionClick); 
        });

    });
    </script>
</body>
</html>
